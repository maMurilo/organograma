<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Organograma de Fazenda</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .organograma {
      margin-top: 20px;
    }
    .node {
      margin-left: 20px;
      border-left: 2px solid #ccc;
      padding-left: 10px;
      margin-bottom: 10px;
    }
    .lider {
      font-weight: bold;
      color: #2c3e50;
    }
    .liderado {
      margin-left: 20px;
    }
  </style>
</head>
<body>
  <h2>Escolha uma fazenda:</h2>
  <select id="fazendaSelect">
    <option value="">-- Selecione --</option>
  </select>

  <div id="organograma" class="organograma"></div>

  <script>
    const relacoes = [
      { fazenda:"FESP", lider: "Ana", liderado: "Bruno" },
      { fazenda:"FESP", lider: "Ana", liderado: "Pedro" },
      { fazenda:"FESP", lider: "Ana", liderado: "Ana 2" },
      { fazenda:"FSTV", lider: "Bruno", liderado: "Carlos" },
      { fazenda:"FSTV", lider: "Carlos", liderado: "Joao" },
      { fazenda:"MTR", lider: "Pedro", liderado: "Maria" },
      { fazenda:"FPA", lider: "Maria", liderado: "Julia" },
      { fazenda:"FPA", lider: "Maria", liderado: "Lara" },
      { fazenda:"FBG", lider: "Maria", liderado: "Lara" },
      { fazenda:"FPA", lider: "Maria", liderado: "Lara" },
      { fazenda:"FEA", lider: "Maria", liderado: "Lara" },
      { fazenda:"FBLA", lider: "Maria", liderado: "Lara" },
      { fazenda:"FESP", lider: "Maria", liderado: "Lara" }
    ];

    const fazendaSelect = document.getElementById("fazendaSelect");
    const organogramaDiv = document.getElementById("organograma");

    // Fazendas únicas
    const fazendasUnicas = [...new Set(relacoes.map(r => r.fazenda))];
    fazendasUnicas.forEach(fazenda => {
      const option = document.createElement("option");
      option.value = fazenda;
      option.textContent = fazenda;
      fazendaSelect.appendChild(option);
    });

    // Evento de mudança no dropdown
    fazendaSelect.addEventListener("change", () => {
      const fazendaSelecionada = fazendaSelect.value;
      organogramaDiv.innerHTML = "";

      if (!fazendaSelecionada) return;

      // Filtra relações por fazenda
      const relacoesFazenda = relacoes.filter(r => r.fazenda === fazendaSelecionada);

      // Monta um mapa: líder -> [liderados]
      const mapaLideres = {};
      relacoesFazenda.forEach(({ lider, liderado }) => {
        if (!mapaLideres[lider]) {
          mapaLideres[lider] = new Set();
        }
        mapaLideres[lider].add(liderado);
      });

      // Renderiza organograma
      for (const lider in mapaLideres) {
        const nodeDiv = document.createElement("div");
        nodeDiv.className = "node";

        const liderEl = document.createElement("div");
        liderEl.className = "lider";
        liderEl.textContent = lider;
        nodeDiv.appendChild(liderEl);

        mapaLideres[lider].forEach(liderado => {
          const lideradoEl = document.createElement("div");
          lideradoEl.className = "liderado";
          lideradoEl.textContent = `├── ${liderado}`;
          nodeDiv.appendChild(lideradoEl);
        });

        organogramaDiv.appendChild(nodeDiv);
      }
    });
  </script>
</body>
</html>
